<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Há»c Tá»« Vá»±ng Cho BÃ©</title>

<style>
/* ===== Base ===== */
body {
  margin: 0;
  font-family: system-ui, sans-serif;
  background: #f5f5f5;
}

/* ===== Tabs ===== */
.tabs {
  display: flex;
  background: #4a90e2;
}
textarea {
  resize: vertical;
}
input,
textarea,
select,
button {
  box-sizing: border-box;
}

.tabs button {
  flex: 1;
  padding: 16px;
  font-size: 18px;
  border: none;
  color: white;
  background: none;
}

.tabs button.active {
  background: #357abd;
}

section {
  display: none;
  padding: 16px;
}

section.active {
  display: block;
}

/* ===== Form ===== */
input, textarea, select {
  width: 100%;
  padding: 14px;
  margin: 6px 0;
  font-size: 18px;
}

button {
  padding: 14px;
  font-size: 18px;
  margin-top: 8px;
}

#successMsg {
  display: none;
  color: green;
  font-size: 18px;
  margin-top: 8px;
}

/* ===== Cards Grid ===== */
.cards {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
  gap: 16px;
}

/* ===== Card Core ===== */
.card {
  width: 100%;
  aspect-ratio: 1 / 1;        /* ğŸ”’ KhÃ³a kÃ­ch thÆ°á»›c */
  perspective: 1000px;
}

.card-inner {
  position: relative;
  width: 100%;
  height: 100%;
  transform-style: preserve-3d;
  transition: transform 0.6s;
}

.card.flipped .card-inner {
  transform: rotateY(180deg);
}

/* ===== Card Faces ===== */
.card-face {
  position: absolute;
  inset: 0;                  /* ğŸ”’ KhÃ´ng cho giÃ£n */
  backface-visibility: hidden;
  border-radius: 20px;
  overflow: hidden;          /* ğŸ”’ Cháº·n phÃ¬nh */
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 12px;
  box-sizing: border-box;
}

/* ===== Front ===== */
.card-front {
  background: #ffffff;
}

.card-front img {
  width: 100%;
  height: 100%;
  object-fit: contain;       /* ğŸ”‘ KhÃ´ng lÃ m phÃ¬nh */
  border-radius: 16px;       /* âœ… Bo gÃ³c má»m máº¡i */
}

/* ===== Back ===== */
.card-back {
  transform: rotateY(180deg);
  text-align: center;
  color: #222;
  overflow-y: auto;
}

.word {
  font-size: 26px;
  font-weight: bold;
}

.example {
  margin-top: 8px;
  font-size: 18px;
}

/* ===== Highlight ===== */
mark {
  background: #ffeb3b;
  padding: 2px 4px;
  border-radius: 4px;
}

/* ===== Tablet-friendly Star ===== */
.star {
  position: absolute;
  top: 10px;
  right: 10px;
  width: 48px;
  height: 48px;
  border-radius: 50%;
  background: rgba(255,255,255,0.9);
  box-shadow: 0 2px 6px rgba(0,0,0,0.25);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 30px;
  cursor: pointer;
  transition: transform 0.15s ease;
}

.star:active {
  transform: scale(0.9);
}

.star.marked {
  background: #ffd700;
}

/* ===== Custom Radio â€“ FIX tráº¡ng thÃ¡i Ä‘Æ°á»£c chá»n ===== */
label {
  display: flex;
  align-items: center;
  gap: 12px;
  font-size: 18px;
  margin: 10px 0;
  cursor: pointer;
}

/* áº¨n radio máº·c Ä‘á»‹nh */
label input[type="radio"] {
  appearance: none;
  -webkit-appearance: none;
  width: 28px;
  height: 28px;
  border-radius: 50%;
  border: 2px solid #4a90e2;
  background: white;
  position: relative;
  flex-shrink: 0;
}

/* khi Ä‘Æ°á»£c chá»n â€“ váº½ cháº¥m trÃ²n */
label input[type="radio"]:checked::after {
  content: "";
  width: 14px;
  height: 14px;
  background: #4a90e2;
  border-radius: 50%;
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
}

/* hiá»‡u á»©ng tap cho tablet */
label input[type="radio"]:active,
label:active input[type="radio"] {
  transform: scale(0.9);
}

/* ===== Action buttons row ===== */
.action-row {
  display: flex;
  justify-content: space-between; /* ğŸ”‘ tÃ¡ch 2 Ä‘áº§u */
  align-items: center;
  margin-top: 12px;
  gap: 12px;
}

/* nÃºt nguy hiá»ƒm */
button.danger {
  background: #e74c3c;
  color: white;
}
/* ===== Button style ===== */
button {
  border-radius: 10px;      /* bo gÃ³c má»m, thÃ¢n thiá»‡n tráº» em */
  padding: 10px 16px;
}

/* ===== Dropdown / Select ===== */
select {
  border-radius: 10px;
  padding: 8px 12px;
}

/* Optional: input text náº¿u cÃ³ */
input[type="text"],
input[type="number"] {
  border-radius: 10px;
  padding: 8px 12px;
}

/* Hover & focus nháº¹ */
button:hover {
  opacity: 0.95;
}

button:focus,
select:focus,
input:focus {
  outline: none;
  box-shadow: 0 0 0 2px rgba(0, 0, 0, 0.1);
}
.import-note {
  background: #ffffff;
  border-left: 5px solid #4a90e2;
  padding: 12px 14px;
  margin-top: 10px;
  font-size: 16px;
  border-radius: 10px;
}

.import-note code {
  display: block;
  background: #f0f0f0;
  padding: 8px;
  border-radius: 8px;
  margin: 6px 0;
  font-family: monospace;
  font-size: 15px;
}

.import-note ul {
  padding-left: 18px;
  margin: 6px 0;
}

.import-note li {
  margin-bottom: 4px;
}
/* ===== Primary buttons ===== */
button.primary {
  background: #4a90e2;        /* xanh dá»‹u â€“ hÃ nh Ä‘á»™ng chÃ­nh */
  color: white;
  border: none;
}

button.primary:active {
  transform: scale(0.96);
}

button.primary:hover {
  background: #357abd;
}

/* NÃºt há»c â€“ xanh lÃ¡ táº¡o cáº£m giÃ¡c tÃ­ch cá»±c */
button.learn {
  background: #2ecc71;        /* xanh lÃ¡ thÃ¢n thiá»‡n */
  color: white;
  border: none;
}

button.learn:hover {
  background: #27ae60;
}

</style>
</head>

<body>

<!-- ===== Tabs ===== -->
<div class="tabs">
  <button class="active" onclick="showTab(0)">â• Nháº­p tá»«</button>
  <button onclick="showTab(1)">ğŸ´ Há»c tá»«</button>
</div>

<!-- ===== Add Word ===== -->
<section class="active">
  <h2>ThÃªm tá»« má»›i</h2>

  <input id="word" placeholder="Tá»« vá»±ng">
  <textarea id="example" placeholder="Máº«u cÃ¢u (khÃ´ng báº¯t buá»™c)"></textarea>
  <input id="image" placeholder="Link hÃ¬nh áº£nh">

  <select id="folderSelect"></select>
  <input id="newFolder" placeholder="Hoáº·c táº¡o thÆ° má»¥c má»›i">

  <div class="action-row">
  <button onclick="addWord()" class="primary">â• ThÃªm</button>
  <div id="successMsg">âœ… ThÃªm tá»« thÃ nh cÃ´ng</div>

    <button onclick="clearAllMarks()" class="danger">
    âŒ XÃ³a toÃ n bá»™ Ä‘Ã¡nh dáº¥u tá»«
    </button>

    <button onclick="clearAllWords()" class="danger">
    ğŸ—‘ï¸ XÃ³a toÃ n bá»™ tá»« vá»±ng
  </button>
  </div>



  <h3>Import tá»« file text</h3>
  <div class="import-note">
  <strong>ğŸ“„ Äá»‹nh dáº¡ng file text:</strong><br>
  Má»—i dÃ²ng lÃ  <b>1 tá»« vá»±ng</b>, cÃ¡c pháº§n Ä‘Æ°á»£c phÃ¢n tÃ¡ch báº±ng dáº¥u <b>:</b><br><br>

  <code>Tá»« : PhÃ¢n loáº¡i : Máº«u cÃ¢u : Link hÃ¬nh</code><br><br>

  <strong>Quy táº¯c:</strong>
  <ul>
    <li>PhÃ¢n loáº¡i vÃ  Máº«u cÃ¢u <b>khÃ´ng báº¯t buá»™c</b></li>
    <li>Náº¿u bá» trá»‘ng, váº«n pháº£i giá»¯ dáº¥u <b>:</b></li>
    <li>KhÃ´ng cÃ³ phÃ¢n loáº¡i â†’ tá»± Ä‘á»™ng vÃ o <b>ChÆ°a phÃ¢n loáº¡i</b></li>
  </ul>

  <strong>VÃ­ dá»¥:</strong><br>
  <code>
    Apple::I eat an apple:https://example.com/apple.png<br>
    Dog:Animals:The dog is running:https://example.com/dog.jpg<br>
    Cat:::https://example.com/cat.png
  </code>
</div>

  <input type="file" accept=".txt" onchange="importFile(this)">
</section>

<!-- ===== Learn ===== -->
<section>
  <h2>Há»c tá»«</h2>
  <select id="folderFilter"></select>
<label>
  <input type="radio" name="markedMode" id="onlyMarked">
  Chá»‰ há»c tá»« Ä‘Ã£ Ä‘Ã¡nh dáº¥u
</label>

<label>
  <input type="radio" name="markedMode" id="includeMarked">
  Bao gá»“m tá»« Ä‘Ã£ Ä‘Ã¡nh dáº¥u
</label>


<button onclick="render()" class="learn">â–¶ï¸ Báº¯t Ä‘áº§u há»c</button>

  <div class="cards" id="cards"></div>
</section>

<script>
/* ===== Data ===== */
const COLORS = ["#FFB6C1","#FFD966","#A8DADC","#B5EAD7","#CDB4DB","#FFDAC1"];
const DEFAULT_FOLDER = "ChÆ°a phÃ¢n loáº¡i";

let data = JSON.parse(localStorage.getItem("vocab") || "[]");

const folderSelect = document.getElementById("folderSelect");
const folderFilter = document.getElementById("folderFilter");
const includeMarkedRadio = document.getElementById("includeMarked");
const onlyMarkedRadio = document.getElementById("onlyMarked");

/* ===== Tabs ===== */
function showTab(i){
  document.querySelectorAll("section").forEach((s,idx)=>s.classList.toggle("active",idx===i));
  document.querySelectorAll(".tabs button").forEach((b,idx)=>b.classList.toggle("active",idx===i));
  loadFolders();
}

/* ===== Form ===== */
function clearForm(){
  word.value = "";
  example.value = "";
  image.value = "";
  newFolder.value = "";
  folderSelect.value = "";
}

function showSuccess(){
  successMsg.style.display = "block";
  setTimeout(()=>successMsg.style.display="none",2000);
}

/* ===== Add Word ===== */
function addWord(obj){
  const wordVal = obj?.word || word.value.trim();
  const exampleVal = obj?.example || example.value.trim();
  const imageVal = obj?.image || image.value.trim();
  const folder =
    obj?.folder ||
    newFolder.value.trim() ||
    folderSelect.value ||
    DEFAULT_FOLDER;

  if(!wordVal || !imageVal) return;

  data.push({
    word: wordVal,
    example: exampleVal,
    image: imageVal,
    folder,
    color: COLORS[Math.floor(Math.random()*COLORS.length)],
    marked: false
  });

  save();
  clearForm();
  showSuccess();
}

/* ===== Import ===== */
function importFile(input){
  const reader = new FileReader();
  reader.onload = () => {
    reader.result.split("\n").forEach(line=>{
      if(!line.trim()) return;
      const p = line.split(":");
      addWord({
        word: p[0]?.trim(),
        folder: p[1]?.trim(),
        example: p[2]?.trim(),
        image: p[3]?.trim()
      });
    });
  };
  reader.readAsText(input.files[0]);
}

/* ===== Folder ===== */
function loadFolders(){
  const folders = [...new Set(data.map(x=>x.folder || DEFAULT_FOLDER))].sort();
  folderSelect.innerHTML = `<option value="">${DEFAULT_FOLDER}</option>`;
  folderFilter.innerHTML = `<option value="">-- Táº¥t cáº£ --</option>`;
  folders.forEach(f=>{
    folderSelect.innerHTML += `<option>${f}</option>`;
    folderFilter.innerHTML += `<option>${f}</option>`;
  });
}

/* ===== Highlight ===== */
function highlight(sentence, word){
  if(!sentence) return "";
  return sentence.replace(new RegExp(`(${word})`, "gi"), "<mark>$1</mark>");
}

/* ===== Render ===== */
function render(){
  cards.innerHTML = "";

  data.filter(x => {
  // 1ï¸âƒ£ Æ¯u tiÃªn: chá»‰ há»c tá»« Ä‘Ã£ Ä‘Ã¡nh dáº¥u
  if (onlyMarkedRadio.checked) {
    return x.marked;
  }

  // 2ï¸âƒ£ CÃ³ chá»n thÆ° má»¥c
  if (folderFilter.value) {
    // thuá»™c thÆ° má»¥c Ä‘ang há»c
    if (x.folder === folderFilter.value) return true;

    // hoáº·c lÃ  tá»« Ä‘Ã£ Ä‘Ã¡nh dáº¥u & cho phÃ©p bao gá»“m
    if (includeMarkedRadio.checked && x.marked) return true;

    return false;
  }

  // 3ï¸âƒ£ KhÃ´ng chá»n gÃ¬ â†’ hiá»‡n táº¥t cáº£
  return true;
}).forEach(item=>{
    const card = document.createElement("div");
    card.className = "card";

    card.innerHTML = `
      <div class="card-inner">
        <div class="card-face card-front">
          <img src="${item.image}">
        </div>
        <div class="card-face card-back" style="background:${item.color}">
          <div class="star ${item.marked ? "marked" : ""}">${item.marked ? "â­" : "â˜†"}</div>
          <div class="word">${item.word}</div>
          <div class="example">${highlight(item.example,item.word)}</div>
        </div>
      </div>
    `;

    const inner = card.querySelector(".card-inner");
    const star = card.querySelector(".star");

    inner.addEventListener("pointerup", e=>{
      if(e.target.closest(".star")) return;
      card.classList.toggle("flipped");
    });

    star.addEventListener("pointerup", e=>{
      e.stopPropagation();
      item.marked = !item.marked;
      save();
      render();
    });

    cards.appendChild(card);
  });
}

function clearAllMarks() {
  const confirmed = confirm(
    "âš ï¸ Báº¡n cÃ³ cháº¯c cháº¯n muá»‘n xÃ³a Táº¤T Cáº¢ cÃ¡c tá»« Ä‘Ã£ Ä‘Ã¡nh dáº¥u?\nHÃ nh Ä‘á»™ng nÃ y khÃ´ng thá»ƒ hoÃ n tÃ¡c."
  );

  if (!confirmed) return;

  let changed = false;

  data.forEach(item => {
    if (item.marked) {
      item.marked = false;
      changed = true;
    }
  });

  if (changed) {
    save();
    alert("âœ… ÄÃ£ xÃ³a toÃ n bá»™ Ä‘Ã¡nh dáº¥u tá»«");
  } else {
    alert("â„¹ï¸ KhÃ´ng cÃ³ tá»« nÃ o Ä‘ang Ä‘Æ°á»£c Ä‘Ã¡nh dáº¥u");
  }
}


/* ===== Save ===== */
function save(){
  localStorage.setItem("vocab",JSON.stringify(data));
  loadFolders();
}
function clearAllWords() {
  if (!confirm("âš ï¸ XÃ³a TOÃ€N Bá»˜ tá»« vá»±ng?")) return;
  if (!confirm("â— Báº¡n cháº¯c cháº¯n 100%? Dá»¯ liá»‡u sáº½ máº¥t vÄ©nh viá»…n.")) return;

  data = [];
  save();
  cards.innerHTML = "";

  alert("âœ… ÄÃ£ xÃ³a toÃ n bá»™ tá»« vá»±ng");
}


loadFolders();
</script>

</body>
</html>
